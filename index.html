<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„ä¸ªäººå­¦ä¹ ä¸»é¡µ | å¤§å­¦ç”Ÿ</title>
    <style>
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", sans-serif;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        a {
            text-decoration: none;
            color: inherit;
        }
        button {
            cursor: pointer;
            border: none;
            background: none;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        /* å¯¼èˆªæ æ ·å¼ - æ ¸å¿ƒè°ƒæ•´ï¼šç™»å½•å…¥å£ç§»åˆ°å³ä¸Šè§’ */
        header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ï¼Œå®ç°ç™»å½•å…¥å£å³å¯¹é½ */
            align-items: center;
            padding: 0 20px;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }
        /* å¯¼èˆªé“¾æ¥åŒºåŸŸ */
        .nav-links {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .nav-links a {
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .nav-links a:hover {
            background-color: #34495e;
        }
        /* ç™»å½•/ç”¨æˆ·ä¿¡æ¯åŒºåŸŸï¼ˆå³ä¸Šè§’ï¼‰ */
        .auth-area {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .auth-btn {
            background-color: #3498db;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .auth-btn:hover {
            background-color: #2980b9;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
        }
        .sign-btn {
            background-color: #e67e22;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .sign-btn:hover {
            background-color: #d35400;
        }
        .sign-btn.disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        /* ä¸ªäººä»‹ç»æ ·å¼ */
        .profile {
            display: flex;
            align-items: center;
            gap: 30px;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 40px;
        }
        .profile-img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #ecf0f1;
        }
        .profile-info h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        .profile-info p {
            margin-bottom: 10px;
            color: #666;
        }
        .tag {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            margin-right: 10px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        /* å­¦ä¹ èµ„æ–™æ ·å¼ */
        .materials {
            margin-bottom: 40px;
        }
        .materials h2 {
            font-size: 1.6rem;
            margin-bottom: 20px;
            color: #2c3e50;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }
        .material-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .material-card {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }
        .material-card:hover {
            transform: translateY(-5px);
        }
        .material-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .material-card p {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        .material-card a {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .material-card a:hover {
            background-color: #2980b9;
        }
        /* è”ç³»æ–¹å¼æ ·å¼ - ä¿®æ­£å¸ƒå±€å’Œæ ‡ç­¾é”™è¯¯ */
        .contact {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 40px;
        }
        .contact h2 {
            font-size: 1.6rem;
            margin-bottom: 20px;
            color: #2c3e50;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .contact-item {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.1rem;
        }
        .contact-item i {
            color: #3498db;
            font-size: 1.2rem;
            width: 24px; /* å›ºå®šå›¾æ ‡å®½åº¦ï¼Œå¯¹é½æ›´æ•´é½ */
            text-align: center;
        }
        /* é¡µè„šæ ·å¼ */
        footer {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 40px;
        }
        footer p {
            font-size: 1rem;
        }
        /* å“åº”å¼æ ·å¼ - é€‚é…æ‰‹æœºç«¯ */
        @media (max-width: 768px) {
            .profile {
                flex-direction: column;
                text-align: center;
            }
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }
            .nav-links, .auth-area {
                flex-wrap: wrap;
                justify-content: center;
            }
            .contact-item {
                font-size: 1rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- å¯¼èˆªæ  - é‡æ„å¸ƒå±€ï¼Œç™»å½•å…¥å£ç§»åˆ°å³ä¸Šè§’ -->
    <header>
        <div class="nav-container">
            <div class="logo">æˆ‘çš„å­¦ä¹ ä¸»é¡µ</div>
            
            <!-- å¯¼èˆªé“¾æ¥åŒºåŸŸ -->
            <div class="nav-links">
                <a href="#profile">ä¸ªäººä»‹ç»</a>
                <a href="#materials">å­¦ä¹ èµ„æ–™</a>
                <a href="#contact">è”ç³»æ–¹å¼</a>
                <a href="admin.html" id="admin-link" style="display: none;">ç®¡ç†å‘˜åå°</a>
            </div>
            
            <!-- ç™»å½•/ç”¨æˆ·ä¿¡æ¯åŒºåŸŸï¼ˆå³ä¸Šè§’ï¼‰ -->
            <div class="auth-area">
                <!-- æœªç™»å½•æ˜¾ç¤ºç™»å½•å…¥å£ -->
                <div id="auth-entrance" style="display: block;">
                    <a href="login.html" class="auth-btn">ç™»å½•/æ³¨å†Œ</a>
                </div>
                <!-- ç™»å½•åæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ -->
                <div id="user-area" class="user-info" style="display: none;">
                    <span>ğŸ‘¤ <span id="username">ç”¨æˆ·å</span></span>
                    <span>ç§¯åˆ†ï¼š<span id="points">0</span> âœ¨</span>
                    <button class="sign-btn" id="sign-btn">ä»Šæ—¥ç­¾åˆ°</button>
                    <button class="auth-btn" id="logout-btn">é€€å‡º</button>
                </div>
            </div>
        </div>
    </header>

    <!-- ä¸»ä½“å†…å®¹ -->
    <div class="container" id="main-container">
        <!-- ä¸ªäººä»‹ç» -->
        <section class="profile" id="profile">
            <img src="http://q1.qlogo.cn/g?b=qq&nk=2777136265&s=100" alt="ä¸ªäººå¤´åƒ" class="profile-img" id="user-avatar">
            <div class="profile-info">
                <h2>é£ç¿”çš„ç¾Šç¾Š | ç”Ÿæ€å­¦ä¸“ä¸š</h2>
                <p>ğŸ‘‹ å¤§å®¶å¥½ï¼æˆ‘æ˜¯ä¸€åå¤§äºŒå­¦ç”Ÿï¼Œçƒ­çˆ±å­¦ä¹ å’Œåˆ†äº«ï¼Œå¸Œæœ›é€šè¿‡è¿™ä¸ªä¸»é¡µå’Œå¤§å®¶äº¤æµå­¦ä¹ å¿ƒå¾—ï¼Œå…±äº«ä¼˜è´¨å­¦ä¹ èµ„æºï½</p>
                <p>ğŸ“š æ“…é•¿é¢†åŸŸï¼šæ— </p>
                <p>ğŸ¯ è¿‘æœŸç›®æ ‡ï¼šæ— </p>
                <div>
                    <span class="tag">ç”Ÿæ€ä¸“ä¸š</span>
                    <span class="tag">å­¦ä¹ åˆ†äº«</span>
                    <span class="tag">å‰ç«¯å¼€å‘</span>
                    <span class="tag">ç®—æ³•åˆ·é¢˜</span>
                </div>
            </div>
        </section>

        <!-- å­¦ä¹ èµ„æ–™åˆ†äº« -->
        <section class="materials" id="materials">
            <h2>ğŸ“– å­¦ä¹ èµ„æ–™åˆ†äº«</h2>
            <div class="material-list">
                <div class="material-card">
                    <h3>å­¦ä¹ èµ„æ–™åˆ†äº«</h3>
                    <p>åŒ…å«ç”Ÿç‰©åŒ–å­¦ã€åŠ¨ç‰©å­¦ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œé™„åˆ·é¢˜æ€è·¯å’Œä¾‹é¢˜è§£æ</p>
                    <a href="https://pan.baidu.com/s/1739wCLzmLSAdvMsW3vzdPw?pwd=5xq9" target="_blank">ä¸‹è½½PDF</a>
                </div>
                <div class="material-card">
                    <h3>Pythonå…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹</h3>
                    <p>é€‚åˆé›¶åŸºç¡€ï¼Œæ¶µç›–åŸºç¡€è¯­æ³•ã€çˆ¬è™«ã€æ•°æ®åˆ†æã€å°é¡¹ç›®å®æˆ˜ï¼ˆé™„æºç ï¼‰</p>
                    <a href="#" target="_blank">æŸ¥çœ‹æ•™ç¨‹</a>
                </div>
                <div class="material-card">
                    <h3>å‰ç«¯é¢è¯•é«˜é¢‘è€ƒç‚¹æ•´ç†</h3>
                    <p>HTML/CSS/JSæ ¸å¿ƒè€ƒç‚¹ã€æµè§ˆå™¨åŸç†ã€æ¡†æ¶é¢è¯•é¢˜ï¼Œé™„å‚è€ƒç­”æ¡ˆ</p>
                    <a href="#" target="_blank">è·å–èµ„æ–™</a>
                </div>
                <div class="material-card">
                    <h3>è“æ¡¥æ¯å†å¹´çœŸé¢˜åŠè§£æ</h3>
                    <p>è¿‘5å¹´è“æ¡¥æ¯çœèµ›/å›½èµ›çœŸé¢˜ï¼ŒåŒ…å«C++/Pythonä¸¤ç§è§£æ³•ï¼Œé™„è¯„åˆ†æ ‡å‡†</p>
                    <a href="#" target="_blank">ä¸‹è½½çœŸé¢˜</a>
                </div>
            </div>
        </section>

        <!-- è”ç³»æ–¹å¼ - ä¿®æ­£HTMLæ ‡ç­¾é”™è¯¯ -->
        <section class="contact" id="contact">
            <h2>ğŸ“ è”ç³»æ–¹å¼</h2>
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>é‚®ç®±ï¼š2777136265@qq.com</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-wechat"></i>
                    <span>å¾®ä¿¡ï¼šfly_sheep1ï¼ˆå¤‡æ³¨ï¼šå­¦ä¹ äº¤æµï¼‰</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-github"></i>
                    <span>GitHubï¼šgithub.com/ä½ çš„ç”¨æˆ·å</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-qq"></i>
                    <span>QQï¼š2777136265</span>
                </div>
            </div>
        </section>
    </div>

    <!-- é¡µè„š -->
    <footer>
        <p>Â© 2025 æˆ‘çš„ä¸ªäººå­¦ä¹ ä¸»é¡µ | å¤§å­¦ç”Ÿå­¦ä¹ åˆ†äº«å¹³å°</p>
        <p style="margin-top: 0.5rem; font-size: 0.9rem;">æ„¿æˆ‘ä»¬éƒ½åœ¨å­¦ä¹ çš„è·¯ä¸Šä¸æ–­è¿›æ­¥ï½</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // ==================== Supabaseæ ¸å¿ƒé…ç½®ï¼ˆæ›¿æ¢ä¸ºä½ çš„ï¼ï¼‰====================
        const SUPABASE_URL = 'https://neflfdfpzyjookonmleo.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5lZmxmZGZwenlqb29rb25tbGVvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzNzQxMTUsImV4cCI6MjA4MDk1MDExNX0.z944F1VmJO9ro-1iDtB9HD_1NVThzz7mzqSX0IQqj68';
        
        // åˆå§‹åŒ–Supabaseå®¢æˆ·ç«¯
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // é¡µé¢åŠ è½½åæ‰§è¡Œ
        window.onload = async function() {
            await checkLoginStatus(); // æ£€æŸ¥ç™»å½•çŠ¶æ€
            bindLogoutEvent(); // ç»‘å®šé€€å‡ºç™»å½•äº‹ä»¶
            bindSignEvent(); // ç»‘å®šç­¾åˆ°äº‹ä»¶
        };

        // ==================== æ£€æŸ¥ç™»å½•çŠ¶æ€ ====================
        async function checkLoginStatus() {
            try {
                const { data: { session } } = await supabase.auth.getSession();
                const authEntrance = document.getElementById('auth-entrance');
                const userArea = document.getElementById('user-area');
                const signBtn = document.getElementById('sign-btn');

                if (session) {
                    // å·²ç™»å½•ï¼šæ˜¾ç¤ºç”¨æˆ·åŒºåŸŸï¼Œéšè—ç™»å½•å…¥å£
                    authEntrance.style.display = 'none';
                    userArea.style.display = 'flex';
                    signBtn.style.display = 'block';

                    // è·å–ç”¨æˆ·ä¿¡æ¯å¹¶æ¸²æŸ“
                    await renderUserInfo(session.user.id);
                    // æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²ç­¾åˆ°
                    await checkSignStatus();
                } else {
                    // æœªç™»å½•ï¼šæ˜¾ç¤ºç™»å½•å…¥å£ï¼Œéšè—ç”¨æˆ·åŒºåŸŸ
                    authEntrance.style.display = 'block';
                    userArea.style.display = 'none';
                }
            } catch (err) {
                console.error('æ£€æŸ¥ç™»å½•çŠ¶æ€å¤±è´¥ï¼š', err);
                alert('ç™»å½•çŠ¶æ€æ£€æµ‹å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢');
            }
        }

        // ==================== æ¸²æŸ“ç”¨æˆ·ä¿¡æ¯ ====================
        async function renderUserInfo(userId) {
            try {
                const { data: userProfile, error } = await supabase
                    .from('users')
                    .select('username, points')
                    .eq('id', userId)
                    .single();

                if (error) throw new Error('æœªæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯');

                // æ›´æ–°é¡µé¢ä¸Šçš„ç”¨æˆ·åå’Œç§¯åˆ†
                document.getElementById('username').textContent = userProfile.username;
                document.getElementById('points').textContent = userProfile.points || 0;
            } catch (err) {
                console.error('æ¸²æŸ“ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼š', err);
                document.getElementById('username').textContent = 'æœªçŸ¥ç”¨æˆ·';
            }
        }

        // ==================== æ£€æŸ¥ä»Šæ—¥ç­¾åˆ°çŠ¶æ€ ====================
        async function checkSignStatus() {
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (!session) return;

                const today = new Date().toISOString().split('T')[0]; // ä»Šæ—¥æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
                const signBtn = document.getElementById('sign-btn');

                // æŸ¥è¯¢ç”¨æˆ·ä»Šæ—¥ç­¾åˆ°è®°å½•ï¼ˆéœ€å…ˆåˆ›å»ºsign_recordsè¡¨ï¼‰
                const { data: signRecord } = await supabase
                    .from('sign_records')
                    .select('id')
                    .eq('user_id', session.user.id)
                    .eq('sign_date', today)
                    .single();

                if (signRecord) {
                    // å·²ç­¾åˆ°ï¼šç¦ç”¨ç­¾åˆ°æŒ‰é’®
                    signBtn.textContent = 'ä»Šæ—¥å·²ç­¾åˆ°';
                    signBtn.classList.add('disabled');
                    signBtn.disabled = true;
                } else {
                    // æœªç­¾åˆ°ï¼šå¯ç”¨ç­¾åˆ°æŒ‰é’®
                    signBtn.textContent = 'ä»Šæ—¥ç­¾åˆ°';
                    signBtn.classList.remove('disabled');
                    signBtn.disabled = false;
                }
            } catch (err) {
                // æ— ç­¾åˆ°è®°å½•è¡¨æˆ–æœªç­¾åˆ°ï¼Œé»˜è®¤æ˜¾ç¤ºå¯ç­¾åˆ°
                const signBtn = document.getElementById('sign-btn');
                signBtn.textContent = 'ä»Šæ—¥ç­¾åˆ°';
                signBtn.classList.remove('disabled');
                signBtn.disabled = false;
            }
        }

        // ==================== ç»‘å®šé€€å‡ºç™»å½•äº‹ä»¶ ====================
        function bindLogoutEvent() {
            const logoutBtn = document.getElementById('logout-btn');
            logoutBtn.onclick = async function() {
                try {
                    await supabase.auth.signOut();
                    alert('é€€å‡ºç™»å½•æˆåŠŸï¼');
                    window.location.reload(); // åˆ·æ–°é¡µé¢
                } catch (err) {
                    alert('é€€å‡ºç™»å½•å¤±è´¥ï¼š' + err.message);
                }
            };
        }

        // ==================== ç»‘å®šç­¾åˆ°äº‹ä»¶ ====================
        async function bindSignEvent() {
    const signBtn = document.getElementById('sign-btn');
    signBtn.onclick = async function() {
        try {
            // 1. æ£€æŸ¥ç™»å½•çŠ¶æ€
            const { data: { session }, error: sessionError } = await supabase.auth.getSession();
            if (sessionError) throw new Error('ç™»å½•çŠ¶æ€è·å–å¤±è´¥ï¼š' + sessionError.message);
            if (!session || !session.user) {
                alert('è¯·å…ˆç™»å½•ï¼');
                window.location.href = 'login.html';
                return;
            }
            const userId = session.user.id;
            console.log('å½“å‰ç”¨æˆ·IDï¼š', userId); // æ§åˆ¶å°æ‰“å°IDï¼Œæ–¹ä¾¿æ’æŸ¥

            // 2. ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
            signBtn.disabled = true;
            signBtn.textContent = 'ç­¾åˆ°ä¸­...';

            // 3. æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²ç­¾åˆ°ï¼ˆé¿å…é‡å¤ç­¾åˆ°ï¼‰
            const today = new Date().toISOString().split('T')[0];
            const { data: signRecord } = await supabase
                .from('sign_records')
                .select('id')
                .eq('user_id', userId)
                .eq('sign_date', today)
                .single()
                .catch(() => null); // æœªç­¾åˆ°æ—¶å¿½ç•¥æŠ¥é”™

            if (signRecord) {
                alert('ä»Šæ—¥å·²ç­¾åˆ°ï¼æ— éœ€é‡å¤ç­¾åˆ°');
                signBtn.textContent = 'ä»Šæ—¥å·²ç­¾åˆ°';
                signBtn.classList.add('disabled');
                return;
            }

            // 4. è·å–å½“å‰ç§¯åˆ†ï¼ˆå…¼å®¹æ— è®°å½•çš„æƒ…å†µï¼‰
            let currentPoints = 0;
            const { data: userProfile, error: profileError } = await supabase
                .from('users')
                .select('points')
                .eq('id', userId)
                .single()
                .catch(err => {
                    console.log('ç”¨æˆ·ç§¯åˆ†æŸ¥è¯¢å¤±è´¥ï¼ˆé¦–æ¬¡ç­¾åˆ°ï¼‰ï¼š', err);
                    return { data: null };
                });

            if (userProfile) {
                currentPoints = userProfile.points ?? 0;
            }
            const addPoints = 10;
            const newPoints = currentPoints + addPoints;
            console.log('ç§¯åˆ†æ›´æ–°ï¼š', currentPoints, 'â†’', newPoints); // æ§åˆ¶å°æ‰“å°ç§¯åˆ†

            // 5. æ›´æ–°ç§¯åˆ†ï¼ˆå¼ºåˆ¶å¼€å¯RLSæ—è·¯ï¼Œæµ‹è¯•ç”¨ï¼‰
            const { error: updateError } = await supabase
                .from('users')
                .update({ points: newPoints })
                .eq('id', userId)
                // ä¸´æ—¶æ·»åŠ RLSæ—è·¯ï¼ˆæµ‹è¯•å®Œæˆååˆ é™¤ï¼‰
                .setAuth({ bypassRLS: true });

            if (updateError) {
                throw new Error('ç§¯åˆ†æ›´æ–°å¤±è´¥ï¼š' + updateError.message + 'ï¼ˆæ£€æŸ¥RLSç­–ç•¥/ç”¨æˆ·IDæ˜¯å¦åŒ¹é…ï¼‰');
            }

            // 6. è®°å½•ç­¾åˆ°è®°å½•
            const { error: signError } = await supabase
                .from('sign_records')
                .insert([{
                    user_id: userId,
                    sign_date: today,
                    points: addPoints
                }]);

            if (signError) {
                console.warn('ç­¾åˆ°è®°å½•ä¿å­˜å¤±è´¥ï¼ˆç§¯åˆ†å·²æ›´æ–°ï¼‰ï¼š', signError);
                // ç§¯åˆ†æ›´æ–°æˆåŠŸï¼Œä»…è®°å½•å¤±è´¥ä¸å½±å“ç”¨æˆ·
            }

            // 7. æˆåŠŸæç¤º+æ›´æ–°é¡µé¢
            document.getElementById('points').textContent = newPoints;
            signBtn.textContent = 'ä»Šæ—¥å·²ç­¾åˆ°';
            signBtn.classList.add('disabled');
            alert(`ç­¾åˆ°æˆåŠŸï¼è·å¾—${addPoints}ç§¯åˆ†ï¼Œå½“å‰ç§¯åˆ†ï¼š${newPoints}`);

        } catch (err) {
            // è¯¦ç»†é”™è¯¯æç¤º
            alert(err.message);
            console.error('ç­¾åˆ°å®Œæ•´æŠ¥é”™ï¼š', err);
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            signBtn.textContent = 'ä»Šæ—¥ç­¾åˆ°';
            signBtn.disabled = false;
        }
    };
}
    </script>
</body>
</html>
